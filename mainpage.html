<!DOCTYPE html>
<html>

<head>

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link href="css/hover-min.css" rel="stylesheet" media="all">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
  <!--<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>-->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
  <title>Sun Pass Toll Calculator</title>
  <meta name="viewport" content="initial-scale=1.0">
  <meta charset="utf-8">
  <link rel="stylesheet" type="text/css" href="css/switch-toggle.css">
  <link rel="stylesheet" type="text/css" href="css/floating-container.css">
  <link rel="stylesheet" type="text/css" href="css/legends.css">
  <link rel="stylesheet" type="text/css" href="css/recentTrips.css">
  <link rel="stylesheet" type="text/css" href="css/header.css">
  <link rel="stylesheet" type="text/css" href="css/infoWindow.css">
  <link rel="stylesheet" type="text/css" href="css/headermenu.css">

  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script src="js/loadRegion.js"></script>
  <script src="js/getFacility.js"></script>
  <script src="js/getExitsForRegionAndFacility.js"></script>
  <script src="js/getQualifiedExits.js"></script>
  <script src="js/getTollRoutes.js"></script>
  <script src="js/Queue.js"></script>
  <script src="js/LinkedHashMap.js"></script>
  <style>
    /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */

    /* Optional: Makes the sample page fill the window. */

    html,
    body {
      height: 100%;
      margin: 0;
      padding: 0;
    }
  </style>
</head>

<body onload="loadRecentTripsFromLocal()">
  <div id="container-fluid" style="position:fixed;top:1px;
  left:1px;z-index:4;
  background:#fff;
  width:144px;height:90px;
  padding-left:4px;padding-right:10px;padding-top:4px">
    <span class="headerSpan" style="z-index:3">
      <img src="img/Sunpass_TC_logo.svg" >
      <!--mix-blend-mode: multiply;-->
    </span>
  </div>
  <!--  <div class="container">
    <nav class="navbar-default" style="position:fixed;z-index:4;background:#009d56;top:15px;left:0px;width:146px;height:52px">
      <div class="collapse navbar-collapse">
        <ul class="nav navbar-nav">
        </ul>
      </div>
    </nav>
  </div>-->
  <div class="container">
    <nav class="navbar-default" style="position:fixed;z-index:4;background:#009d56;top:15px;left:146px;width:230px;height:52px">
      <div class="collapse navbar-collapse">
        <ul class="nav navbar-nav">
          <li><a href="#" class="hover-underline-menu" data-menu-underline-from-center style="color:white;font-size:26px"> Toll Calculator</a></li>
        </ul>
      </div>
    </nav>
  </div>

  <div class="container" style="position:fixed;z-index:4;background:#009d56;top:15px;left:376px;height:52px;padding-top:16px;vertical-align:center;width:250px">
    <div class="dropdown">
      <button class="btn btn-primary dropdown-toggle hover-underline-menu" style="background:#009d56;top:15px;border: none;padding-top:5px;" type="button" data-toggle="dropdown">
        <a  style="color:white;font-size:16px;padding-left:5px;padding-right:5px;padding-bottom:10px"><img src="img/UsingCalculator_Icon.png"> Using the calculator</a></button>
      <ul class="dropdown-menu">
        <!--<li><a style="color:#009d56" href="#" data-toggle="tooltip" data-placement="right" trigger="focus" title="Using the Calculator is easy, and is based on selecting the beginning and end of a trip on the highway systems. The process of selecting the start exits and end exits is the same, and can be done either on the map or with the toll calculator control box."> -->
        <li><a style="color:#009d56" data-toggle="modal" data-target="#modal-UTC">
        "Using the Calculator"</a>
        </li>
        <li><a style="color:#009d56" href="http://floridasturnpike.com/travelerInfo.html" data-toggle="tooltip" data-placement="right" trigger="focus" title="Click to navigate to floridasturnpike for other toll transponders">"Other Toll Transponders"
        </a></li>
        <li><a style="color:#009d56" href="#" data-toggle="modal" data-target="#Disclaimer-UTC">
          "Legal Disclaimer"
      </a></li>
      </ul>
    </div>
  </div>
  <div id="modal-UTC" class="modal fade" role="dialog">
    <div class="modal-dialog modal-lg">

      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Using the calculator</h4>
        </div>
        <div class="modal-body">
          <p>"Using the Calculator is easy, and is based on selecting the beginning and end of a trip on the highway systems. The process of selecting the start exits and end exits is the same, and can be done either on the map or with the toll calculator
            control box."</p>
          <div id="myCarousel" class="carousel slide" data-ride="carousel">
            <!-- Indicators -->
            <ol class="carousel-indicators">
              <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
              <li data-target="#myCarousel" data-slide-to="1"></li>
              <li data-target="#myCarousel" data-slide-to="2"></li>
              <li data-target="#myCarousel" data-slide-to="3"></li>
              <li data-target="#myCarousel" data-slide-to="4"></li>
            </ol>
            <!-- Wrapper for slides -->
            <div class="carousel-inner">
              <div class="item active">
                <img src="img/UTC-s1.png" alt="Start">
              </div>

              <div class="item">
                <img src="img/UTC-s2.png" alt="SelectStart">
              </div>

              <div class="item">
                <img src="img/UTC-s3.png" alt="StartBubble">
              </div>

              <div class="item">
                <img src="img/UTC-s4.png" alt="SelectExit">
              </div>

              <div class="item">
                <img src="img/UTC-s5.png" alt="ExitBubble">
              </div>
            </div>

            <!-- Left and right controls -->
            <a class="left carousel-control" href="#myCarousel" data-slide="prev">
        <span class="glyphicon glyphicon-chevron-left"></span>
        <span class="sr-only">Previous</span>
          </a>
            <a class="right carousel-control" href="#myCarousel" data-slide="next">
              <span class="glyphicon glyphicon-chevron-right"></span>
              <span class="sr-only">Next</span>
            </a>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>

    </div>
  </div>
  <!-- Modal -->
  <div id="Disclaimer-UTC" class="modal fade" role="dialog">
    <div class="modal-dialog">

      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Legal Disclaimer</h4>
        </div>
        <div class="modal-body">
          <p>Toll rates effective as of October 29, 2017. In the unlikely event that there is a discrepancy between the toll rates shown in this application and those displayed at the toll collection locations, those shown at the toll collection locations
            are the official toll rates on the Turnpike system facilities.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>

    </div>
  </div>
  <div class="container" style="position:fixed;z-index:4;background:#009d56;top:15px;left:626px;height:52px;padding-top:16px;vertical-align:center;width:200px">
    <div class="dropdown">
      <button class="btn btn-primary dropdown-toggle hover-underline-menu" style="background:#009d56;top:15px;border: none;padding-top:5px;" type="button" data-toggle="dropdown">
        <a  style="color:white;font-size:16px;padding-left:5px;padding-right:5px;padding-bottom:10px"><img src="img/Resources_Icon.png"> Resources</a></button>
      <ul class="dropdown-menu">
        <li><a style="color:#009d56" href="https://www.sunpass.com/index" data-toggle="tooltip" data-placement="right" trigger="focus" title="SunPass is an innovative prepaid toll program. Using a SunPass transponder allows drivers to travel through toll plazas without stopping. SunPass users will always pay the lowest possible toll rates.">
        "SunPass"
        </a></li>
        <li><a style="color:#009d56" href="https://www.sunpass.com/index" data-toggle="tooltip" data-placement="right" trigger="focus" title="Turnpike systems will either accept TOLL-BY-PLATE® or CASH, and both toll rates are the same" .
            "TOLL-BY-PLATE systems take a photo of the vehicle’s license plate and send a summary of the driver’s tolls every 30 days, plus a $2.50 administrative charge. CASH systems have two options: pay the exact toll in the ‘Exact Coins Cars Only’ lanes, and if change or a receipt is needed drive through the ‘Change Provided’ lanes">"Cash/TOLL-BY-PLATE"
        </a></li>
        <li><a style="color:#009d56" href="http://floridaexpresslanes.com/" data-toggle="tooltip" data-placement="right" trigger="focus">
          "Florida Express Lanes"
      </a></li>
        <li><a style="color:#009d56" href="https://fl511.com/" data-toggle="tooltip" data-placement="right" trigger="focus">
        "FL511"
    </a></li>
        <li><a style="color:#009d56" href="http://www.floridasturnpike.com/travelerInfo.html" data-toggle="tooltip" data-placement="right" trigger="focus">
      "Traveler Info"
  </a></li>
        <li><a style="color:#009d56" href="https://www.sunpass.com/tollSavings" data-toggle="tooltip" data-placement="right" trigger="focus">
    "Toll Savings"
</a></li>
        <li><a style="color:#009d56" href="https://www.sunpass.com/participatingAgencies" data-toggle="tooltip" data-placement="right" trigger="focus">
  "Participating Agencies"
</a></li>
        <li><a style="color:#009d56" href="https://www.sunpass.com/contactSunPass" data-toggle="tooltip" data-placement="right" trigger="focus">
  "Contact Sunpass"
</a></li>
        <li><a style="color:#009d56" href="https://www.sunpass.com/violations" data-toggle="tooltip" data-placement="right" trigger="focus">
  "Toll Violations"
</a></li>
      </ul>
    </div>
  </div>
  <!--  <div class="container" style="position:fixed;z-index:4;background:#009d56;top:15px;left:376px;height:52px;padding-top:16px;vertical-align:center;width:250px">
    <span>
    <nav class="hover-underline-menu" data-menu-underline-from-center>
      <ul class="menu align-center navbar-nav">
        <li class="li-menu-items-nodot"><a href="#" style="color:white;font-size:16px;padding-left:5px;padding-right:5px"><img src="img/UsingCalculator_Icon.png"> Using the calculator</a>
        </li>
      </ul>
     </nav>
  </span>
</div>-->
  <!--<div class="container" style="position:fixed;z-index:4;background:#009d56;top:15px;left:626px;height:52px;padding-top:16px;vertical-align:center;width:200px">
    <span>
    <nav class="hover-underline-menu" data-menu-underline-from-center>
      <ul class="menu align-center navbar-nav">
        <li class="li-menu-items-nodot"><a href="#" style="color:white;font-size:16px;padding-left:5px;padding-right:5px"><img src="img/Resources_Icon.png"> Resources</a>
        </li>
      </ul>
     </nav>
  </span>
</div>-->



  <!--<div class="container">
    <nav class="navbar-default"  style="position:fixed;z-index:4;background:#009d56;top:15px;left:146px;">
      <div class="collapse navbar-collapse">
        <ul class="nav navbar-nav">
          <li><a href="#" class="hover-underline-menu"  data-menu-underline-from-center style="color:white;font-size:26px"> Toll Calculator</a></li>
          <li><a href="#" class="hover-underline-menu" data-menu-underline-from-center style="color:white"><img src="img/UsingCalculator_Icon.png"> Using the calculator</a></li>
          <li><a href="#" class="hover-underline-menu"  data-menu-underline-from-center style="color:white"><img src="img/Resources_Icon.png"> Resources</a></li>
        </ul>
      </div>
    </nav>
  </div>-->
  <!--  <div id="container-fluid" style="position:fixed;top:100px;left:10px;z-index:4;background:none">
    <img src="img/Apple_App_Store_Button.png">
  </div>
  <div id="container-fluid" style="position:fixed;top:140px;left:10px;z-index:4;background:none">
    <img src="img/Google_Play_Button.png">
  </div>-->

  <div id="floating-panel" title="Toll Calculator">
    <div id="floating-panel-Header" title="Trip Calculator">
      <span style="">
          <img src="img/Calculator_Icon.png">
        <!--  <label>Trip Calculator</span> -->
      <span style="padding-left:3px;font-size:18px;"> Trip Calculator </span>
      </span>
    </div>
    <div class="bottom-between-dropdowns"></div>
    <!-- payments and axle dropdowns -->
    <div class="container-fluid" title="How do i pay?">
      <span class="axlepayment spanheader" style="padding-right: 5px;">
            Payment Type
            <a href="#">?</a>
          </span>
      <span class="axlepayment spanheader" title="How many axles in my motor ?">
            Axle Count
            <a href="#">?</a>
          </span>
    </div>
    <div class="bottom-between-dropdowns"></div>
    <div>
      <span class="dropdown" style="padding-left:20px;padding-right:20px;width=100%">
  <button class="btn btn-default dropdown-toggle"
          type="button" id="ddlGuiPaymentType"
          data-toggle="dropdown">  <img src="img/SunPass_Button_icon.svg" width="76px" height="34px"  />
    <span class="caret"></span>
      </button>
      <ul class="dropdown-menu" id="ddlUlPaymentType">
        <li>
          <a href="#">
        <img src="img/SunPass_Button_icon.svg" width="76px" height="34px"  /></a>
        </li>
        <li class="divider"></li>
        <li>
          <a href="#">
        <img src="img/Cash_TBP_selector.svg" width="76px" height="34px" /></a>
        </li>
      </ul>
      </span>

      <span class="dropdown" style="padding-left:20px;padding-right:20px;width=100%">
  <button class="btn btn-default dropdown-toggle"
    type="button" id="ddlGuiAxleCount" data-toggle="dropdown">
    <!--aria-haspopup="true" aria-expanded="true"> -->
    <img src="img/2Axles.svg" width="76px" height="34px"/>
    <span class="caret"></span>
      </button>
      <ul class="dropdown-menu" id="ddlUlAxleCount">
        <li id='2'>
          <a href="#">
        <img src="img/2Axles.svg" width="100%" height="100%"  /></a>
        </li>
        <li class="divider"></li>
        <li id='3'>
          <a href="#">
        <img src="img/3Axles.svg" width="100%" height="100%" /></a>
        </li>
        <li class="divider"></li>
        <li id='4'>
          <a href="#">
        <img src="img/4Axles.svg" width="100%" height="100%"  /></a>
        </li>
        <li class="divider"></li>
        <li id='5'>
          <a href="#">
        <img src="img/5Axles.svg" width="100%" height="100%" /></a>
        </li>
        <li class="divider"></li>
        <li id='6'>
          <a href="#">
        <img src="img/6Axles.svg" width="100%" height="100%"  /></a>
        </li>
        <li class="divider"></li>
        <li id="7">
          <a href="#">
        <img src="img/7Axles.svg" width="100%" height="100%" /></a>
        </li>
        <li class="divider"></li>
        <li id="8">
          <a href="#">
        <img src="img/8Axles.svg" width="100%" height="100%"  /></a>
        </li>
      </ul>
      </span>
      <!--  <span style="padding-left:20px;padding-right:20px">
      <select class="selectpicker curtain-menu-shadow .dropdown-menu-axle" hidden="true" id="ddlPaymentType" title="AXLE" data-live-search="true" data-size="1">
    <!--   <option value="select">Payment Type</option>-->
      <!--   <option>Sunpass</option>
       <option>Cash/Toll By Plate</option>

     </select>
   </span>
      <span style="padding-left:20px;padding-right:20px">
      <select class="selectpicker curtain-menu-shadow .dropdown-menu-axle" hidden="true" id="ddlAxleCount" title="AXLE" data-live-search="true" data-size="1">
      <!-- <option value="select">Axles</option>-->
      <!-- <option>1</option>-->
      <!--     <option>2</option>
       <option>3</option>
       <option>4</option>
       <option>5</option>
       <option>6</option>
       <option>7</option>
       <option>8</option>
     </select>
   </span> -->
    </div>
    <div class="bottom-between-dropdowns"></div>
    <div class="container-fluid" id="tripPlanner">
      <div class="spanheader-trips" id="lblSourceTripStart">
        Trip Start
      </div>
      <!--  <div class="dropdown" id="srcRegionDrdn">
        <button  class="btn btn-default dropdown-toggle curtain-menu-shadow button-trips-dropdown" onchange="getFacilities()" onclick="getRegions()" type="button" data-toggle="dropdown">
          Select Region
          <span class="caret"></span>
        </button>
          <ul id="srcRegionList" class="dropdown-menu button-dropdown-menu-trips">
            <li><a href="#">TAMPA BAY</a></li>
            <li><a href="#">CENTRAL EAST COAST</a></li>
            <li><a href="#">SOUTH FLORIDA</a></li>
            <li><a href="#">ORLANDO AREA</a></li>
            <li><a href="#">LAKELAND</a></li>
            <li><a href="#">FLORIDA PANHANDLE</a></li>
          </ul>
        </div>-->
      <select class="selectpicker curtain-menu-shadow button-trips-dropdown" id="srcRegionDrdn" title="SELECT REGION" data-live-search="true" data-size="1">
          <option value="select">SELECT REGION</option>
          <option>TAMPA BAY</option>
          <option>CENTRAL EAST COAST</option>
          <option>SOUTH FLORIDA</option>
          <option>ORLANDO AREA</option>
          <option>LAKELAND</option>
          <option>FLORIDA PANHANDLE</option>
        </select>
      <div class="bottom-between-dropdowns"></div>
      <select class="selectpicker curtain-menu-shadow button-trips-dropdown" id="srcFacilityDrdn" title="SELECT FACILITY" data-live-search="true" data-size="1">
          <option>SELECT FACILITY</option>
      </select>
      <div class="bottom-between-dropdowns"></div>
      <select class="selectpicker curtain-menu-shadow button-trips-dropdown" id="srcExitDrdn" title="SELECT EXIT" data-live-search="true" data-size="1">
          <option>SELECT EXIT</option>
     </select>
      <div class="spanheader-trips" id="lblDestinationTripEnd">
        Trip End
      </div>
      <select class="selectpicker curtain-menu-shadow button-trips-dropdown" id="desRegionDrdn" title="SELECT REGION" data-live-search="true" data-size="1">
          <option value="select">SELECT REGION</option>
        <!--  <option>TAMPA BAY</option>
          <option>CENTRAL EAST COAST</option>
          <option>SOUTH FLORIDA</option>
          <option>ORLANDO AREA</option>
          <option>LAKELAND</option>
          <option>FLORIDA PANHANDLE</option>-->
        </select>
      <div class="bottom-between-dropdowns"></div>
      <select class="selectpicker curtain-menu-shadow button-trips-dropdown" id="desFacilityDrdn" title="SELECT FACILITY" data-live-search="true" data-size="1">
          <option>SELECT FACILITY</option>
        </select>
      <div class="bottom-between-dropdowns"></div>
      <select class="selectpicker curtain-menu-shadow button-trips-dropdown" id="desExitDrdn" title="SELECT EXIT" data-live-search="true" data-size="1">
          <option>SELECT EXIT</option>
        </select>
      <div class="bottom-between-dropdowns"></div>
      <div class="bottom"></div>
      <div class="containter-fluid">
        <span>
                   <span class="spanpadding printer-span-padding " id="lblTollPaymentIndicator">
                       <img src="img/SUNPASS_button.png">
                     </span>
        <span style="color:green;text-align:center;font-size: 25px" class="label .axlepayment" id="lblTollValue"> $ 0.00
                      </span>
        </span>
      </div>
      <div class="bottom-between-dropdowns" style="padding-bottom:0px; padding-top:3px;"></div>
      <div class="bottom"></div>
      <div><button class="btn btn-default" id="btnTraffic" style="border:0px solid transparent;"> <img src="img/Traffic Cars.png"> Traffic</>
        <!--<div style="color:black;text-align:left;font-size: 12px" class="label" id="lblTraffic">Traffic</div></div>-->
      <div><button class="btn btn-default" id="btnReset" style="border:0px solid transparent;"><img src="img/Reset Icon.png"> Reset</></div>
    <!--  <div style="color:black;text-align:left;font-size: 12px" class="label" id="lblReset">Reset</div></div>-->
    </div>
    <div class="bottom-between-dropdowns"></div>
    <div class="bottom"></div>
    <a href="#" class="btn btn-default" id="btnToggleRouteDetails" data-toggle="popover" data-trigger='focus' data-placement="left" title="Route Detail">Route Detail  <span class="caret"></span></a>
  </div>
<!------------>
  <div class="floating-panel-two">
    <div id="floating-panel-Header">
      <span>
          <img src="img/Recent-trips.png">
        <!--  <label>Trip Calculator</span> -->
      <span> Recent Trips </span>
      </span>
    </div>
    <div class="bottom-between-dropdowns"></div>
    <div class="container-fluid">
      <div style="position:relative;">
        <!--  <img src="http://www.patient-experience.org/Images/Stock-Art/For-Patients.aspx" class="img-responsive">-->
        <!-- Control the Parkway with -->
        <button id="btnRecentTrip0" class="btn btn-block" style="display: inline-block; position: absolute;
             top: 0; left: 0;
             width: 100%; height: 20%;
             opacity: 0.3;
             background-color:#7de889; color:#fff;">
             </button>
        <span style="color:#000;text-align:left;font-size: 11px" class="label recentTripLabel" id="lblTrip1Start"> <b>Start :</b>
               </span>
        <span style="color:#000;text-align:left;font-size: 11px;width:150px" class="label recentTripLabel" id="lblTrip1StartValue"> Start Route
               </span>
      </div>
      <div>
        <span style="color:#000;text-align:left;font-size: 11px;" class="label recentTripLabel" id="lblTrip1End"> <b> End : </b>
            </span>
        <span style="color:#000;text-align:left;font-size: 11px;width:150px" class="label recentTripLabel" id="lblTrip1EndValue"> End Route
            </span>
      </div>
    </div>
    <div class="bottom"></div>
    <div class="container-fluid">
      <div style="position:relative;">
        <button id="btnRecentTrip1" class="btn btn-block" style="display: inline-block; position: absolute;
            top: 0; left: 0;
            width: 100%; height: 20%;
            opacity: 0.3;
            background-color:#12a523; color:#fff;"></button>
        <span style="color:#000;text-align:left;font-size: 11px" class="label recentTripLabel" id="lblTrip2Start"> </b> Start :</b>
            </span>
        <span style="color:#000;text-align:left;font-size: 11px;width:150px" class="label recentTripLabel" id="lblTrip2StartValue"> Start Route
            </span>
      </div>
      <div>
        <span style="color:#000;text-align:left;font-size: 11px" class="label recentTripLabel" id="lblTrip2SEnd"> End :
            </span>
        <span style="color:#000;text-align:left;font-size: 11px;width:150px" class="label recentTripLabel" id="lblTrip2EndValue"> End Route
            </span>
      </div>
    </div>
    <div class="bottom"></div>
    <div class="container-fluid">
      <div style="position:relative;">
        <button id="btnRecentTrip2" class="btn btn-block" style="display: inline-block;
             position: absolute;
             top: 0; left: 0;
             width: 100%; height: 20%;
             opacity: 0.3;
             background-color:#296d31; color:#fff;"></button>
        <span style="color:#000;text-align:left;font-size: 11px" class="label recentTripLabel" id="lblTrip3Start"> Start :
            </span>
        <span style="color:#000;text-align:left;font-size: 11px;width:150px" class="label recentTripLabel" id="lblTrip3StartValue"> Start Route
            </span>
      </div>
      <div>
        <span style="color:#000;text-align:left;font-size: 11px" class="label recentTripLabel" id="lblTrip3End"> End :
            </span>
        <span style="color:#000;text-align:left;font-size: 11px;width:150px" class="label recentTripLabel" id="lblTrip3EndValue"> End Route
            </span>
      </div>
    </div>

  </div>

  <div id="legend">
    <div id="legend-Header">
      <span>
          <img src="img/NavigationStar_icon.png">
        <!--  <label>Trip Calculator</span> -->
      <span>Map Legend </span>
      </span>
      <!--  <span >-->
      <div id="container-fluid">
        <table id="legend-grid">
          <tr>
            <td>
              <span style="display:inline-block;vertical-align:top;text-align:left;color:black;font-size:11px;" class="label"> Interchange
             </span>
            </td>
            <td>
              <span style="float:right"> <img src="img/Interchange.png">
              </span>
            </td>
          </tr>
          <tr>
            <td>
              <span style="color:black;text-align:left;font-size: 11px;vertical-align: top" class="label "> Mainline Toll Point
             </span>
            </td>
            <td>
              <img style="float:right" src="img/Toll-Point.png">
            </td>
          </tr>
          <tr>
            <td>
              <span style="color:black;text-align:left;font-size: 11px;vertical-align: top" class="label "> Toll Lanes
             </span>
            </td>
            <td>
              <img style="float:right" src="img/Toll_Lanes_Legend.png">
            </td>
          </tr>
          <tr>
            <td>
              <span style="color:black;text-align:left;font-size: 11px;vertical-align: top" class="label "> Service Plaza
             </span>
            </td>
            <td>
              <img style="float:right" src="img/GasPump_icon.png">
            </td>
          </tr>
        </table>
      </div>
    </div>
  </div>




  <!--<h3> My Google Maps Demo</h3>-->
  <div id="map"></div>
  <!--<p>Click on the map to add interchanges </p> -->
  <script>
    //  var baseURL = "http://165.227.188.171:9991/";
    var baseURL = "http://192.168.1.72:9991/";
    var devBaseURL = "http://192.168.1.72:9991/";
    //  var devBaseURL = "http://172.20.10.7.:9991/";
    var getFacilityurl = baseURL.concat("facility");
    var getRegionsurl = baseURL.concat("regions");
    //    var getExitUrl = baseURL.concat("regionalfacilityexits");
    var getExitUrl = devBaseURL.concat("regionalfacilityexits");
    var getDestinationRegionUrl = baseURL.concat("getDestinationRegions");
    var getDestinationFacilitiesUrl = baseURL.concat("getDestinationFacility");
    var getDestinationExitsUrl = devBaseURL.concat("getDestinationExits");
    var getQualifiedExitsUrl = devBaseURL.concat("getQualifiedExits");
    var getTollRoutesUrl = baseURL.concat("getTollRoutes");
    var getRouteGeometryUrl = baseURL.concat("getTollRouteSectionGeometry");
    //  var getAllInterchangesUrl = baseURL.concat("getAllRouteAttributes");
    var getAllInterchangesUrl = devBaseURL.concat("getAllRouteAttributes");
    //var getAllRouteLineUrl = baseURL.concat("exchanges");
    var getTollPlazasUrl = baseURL.concat("tollPlazas");
    var getSinglePointStatusUrl = baseURL.concat("checkSinglePointOutliers");
    var getMapDestinationExitsUrl = devBaseURL.concat("getQualifiedDestinationExitsAttributes");
    var getUniqueRecentTripUrl = devBaseURL.concat("verifyTripUniqueness");
    var getInterchangesPerRegionurl = baseURL.concat("getPerRegionRouteAttributes");
    var srcRegionSelected;
    var srcFacilitySelected;
    var srcExitSelected;
    var desRegionSelected;
    var desFacilitySelected;
    var axleCount = 2;
    var paymentMethod = "sunPass";
    var paymentId = "sp";
    var generalToll = 0;
    var ddlArray = [];
    var queue = new Queue();
    var axlePath;
    var recentTripFlag = false;
    var mapMarkers = [];
    var exitMapMarkers = [];
    var twoPointMapMarkers = [];
    var otherActiveWindow;
    var isSinglePoint = false;
    var isTripUniqueFlag = false;
    var trafficLayer;
    var GUIRegionSrc;
    var GUIFacilitySrc;
    var GUIExitSrc;
    var GUILatLngSrc;
    var GUIRegionDes;
    var GUIFacilityDes;
    var GUIExitDes;
    var tripVerificationResponse;
    var tripDetails;
    var tripDetailStart;
    var tripDetailEnd;
    var tripDetailTollPlazas;
    var tripDetailStartToll;
    var tripDetailEndToll;
    var TripStateEnum = Object.freeze({
      "start": 0,
      "end": 1,
      "reset": 2
    });
    var currentTripState;
    var positionGeoList = [];
    var opt = {
      minZoom: 7,
      maxZoom: 13
    };

    var tollValue = {
      spValue: 0.00,
      get spValue() {
        return this.spValue.toFixed(2);
      },
      set spValue(s) {
        this.spValue = s;
      }
    };
    var lru = new LinkedHashMap(3);
    var countyLayer;
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    // All change trigger events
    ddlArray.push("srcRegionDrdn");
    ddlArray.push("srcFacilityDrdn");
    ddlArray.push("srcExitDrdn");
    ddlArray.push("desRegionDrdn");
    ddlArray.push("desFacilityDrdn");
    ddlArray.push("desExitDrdn");
    //invariant function for tollValues

    /*  $("#ddlAxleCount").val(axleCount);
        jQuery("#ddlAxleCount option").filter(function(){
                 return $.trim($(this).text()) ==  axleCount
         }).prop('selected', true);
         $('#ddlAxleCount').selectpicker('refresh');*/
    //Axle Count Dropdown
    /*  $('#ddlAxleCount').on('change', function() {
        axleCount = $(this).find("option:selected").val();
        loadCalculatedTollForAxles();
        console.log(axleCount);
      });*/

    /*  $('#ddlPaymentType').on('change', function() {
        paymentMethod = $(this).find("option:selected").val();
        if (paymentMethod === "Cash/Toll By Plate") {
          paymentId = "cash";
        }
        if (paymentMethod === "Sunpass") {
          paymentId = "sp";
        }

        console.log(paymentMethod);
        console.log(paymentId);
        loadCalculatedTollForAxles();
      });*/

    $("[data-menu-underline-from-center] a").addClass("underline-from-center");


    $(document).ready(function() {
      $("ul[id*=ddlUlPaymentType] li").click(function() {

        //ddlGuiPaymentType

        var index = $(this).index();
        if (index == 0) {
          paymentMethod = "Sunpass";
          paymentId = "sp";
          //lblTollPaymentIndicator
          document.getElementById('ddlGuiPaymentType').innerHTML = "<img src=\"img/SunPass_Button_icon.svg\" width=\"76px\" height=\"34px\"/> <span class=\"caret\">";
          document.getElementById('lblTollPaymentIndicator').innerHTML = "<img src=\"img/SunPass_Button_icon.svg\" width=\"76px\" height=\"34px\"/>";
        }
        if (index == 2) {
          paymentMethod = "Cash/Toll By Plate";
          paymentId = "cash";
          document.getElementById('ddlGuiPaymentType').innerHTML = "<img src=\"img/Cash_TBP_selector.svg\" width=\"76px\" height=\"34px\"/> <span class=\"caret\">";
          document.getElementById('lblTollPaymentIndicator').innerHTML = "<img src=\"img/Cash_TBP_selector.svg\" width=\"76px\" height=\"34px\"/>";
        }

        console.log(paymentMethod);
        console.log(paymentId);
        loadCalculatedTollForAxles();


      });
    });

    function loadPaymentMethodImage(paymentId) {
      if (paymentId === "sp") {
        paymentMethod = "Sunpass";
        //lblTollPaymentIndicator
        document.getElementById('ddlGuiPaymentType').innerHTML = "<img src=\"img/SunPass_Button_icon.svg\" width=\"76px\" height=\"34px\"/> <span class=\"caret\">";
        document.getElementById('lblTollPaymentIndicator').innerHTML = "<img src=\"img/SunPass_Button_icon.svg\" width=\"76px\" height=\"34px\"/>";
      }
      if (paymentId === "cash") {
        paymentMethod = "Cash/Toll By Plate";
        document.getElementById('ddlGuiPaymentType').innerHTML = "<img src=\"img/Cash_TBP_selector.svg\" width=\"76px\" height=\"34px\"/> <span class=\"caret\">";
        document.getElementById('lblTollPaymentIndicator').innerHTML = "<img src=\"img/Cash_TBP_selector.svg\" width=\"76px\" height=\"34px\"/>";
      }

    }

    $(document).ready(function() {
      $("ul[id*=ddlUlAxleCount] li").click(function() {
        //ddlGuiAxleCount
        var index = $(this).index();
        switch (index) {
          case 0:
            axleCount = 2;
            loadDropDownImage(axleCount);
            //    document.getElementById('ddlGuiAxleCount').innerHTML = "<img src=\"img/2Axles.svg\" width=\"76px\" height=\"34px\"/> <span class=\"caret\">" ;
            break;
          case 2:
            axleCount = 3;
            loadDropDownImage(axleCount);
            break;
          case 4:
            axleCount = 4;
            loadDropDownImage(axleCount);
            break;
          case 6:
            axleCount = 5;
            loadDropDownImage(axleCount);
            break;
          case 8:
            axleCount = 6;
            loadDropDownImage(axleCount);
            break;
          case 10:
            axleCount = 7;
            loadDropDownImage(axleCount);
            break;
          case 12:
            axleCount = 8;
            loadDropDownImage(axleCount);
            break;
          default:
            axleCount = 2;
            loadDropDownImage(axleCount);
            break;
        }
        console.log(index);
        console.log(axleCount);

        loadCalculatedTollForAxles();
        //  alert('Index is: '+index );
      });
    });

    function loadDropDownImage(AxleCount) {
      var aCount = AxleCount;
      var imageName = aCount + "Axles.svg";
      document.getElementById('ddlGuiAxleCount').innerHTML = "<img src=\"img/" + imageName + "\" width=\"76px\" height=\"34px\"/> <span class=\"caret\">";

    }


    //Source Region Dropdown
    $('#srcRegionDrdn').on('change', function() {
      srcRegionSelected = $(this).find("option:selected").text();
      console.log(srcRegionSelected);
      /*  if (srcRegionSelected === "SELECT REGION") {
          console.log(this.id);
          resetDropDownChain(0);
        }*/
      resetDropDownChain(0);
      loadFacilitiesForSourceRegion(srcRegionSelected);

    });

    //Source facility DropDown
    $('#srcFacilityDrdn').on('change', function() {
      srcFacilitySelected = $(this).find("option:selected").text();
      console.log(srcFacilitySelected);
      /*      if (srcFacilitySelected === "SELECT FACILITY") {
              resetDropDownChain(1);
            }*/
      resetDropDownChain(1);
      loadExitsForSourceRegionAndFacility(srcRegionSelected, srcFacilitySelected);
    });

    //Source Exits DropDown
    $('#srcExitDrdn').on('change', function() {
      srcExitSelected = $(this).find("option:selected").text();
      console.log(srcExitSelected);
      if (srcExitSelected === "SELECT EXIT") {
        resetDropDownChain(2);
      }
      //  loadDestinationExitsForSourceExit(srcRegionSelected, srcFacilitySelected, srcExitSelected);
      resetDropDownChain(2);
      loadDestinationRegionForGivenSource(srcRegionSelected, srcFacilitySelected, srcExitSelected);
    });

    // Destination Region Dropdown
    $('#desRegionDrdn').on('change', function() {
      desRegionSelected = $(this).find("option:selected").text();
      console.log(desRegionSelected);
      if (desRegionSelected === "SELECT REGION") {
        resetDropDownChain(3);
      }
      resetDropDownChain(3);
      loadFacilitiesForDestinationRegion(srcRegionSelected, srcFacilitySelected, srcExitSelected, desRegionSelected);
    });

    //Destination facility DropDown
    $('#desFacilityDrdn').on('change', function() {
      desFacilitySelected = $(this).find("option:selected").text();
      console.log(desFacilitySelected);
      if (desFacilitySelected === "SELECT FACILITY") {
        resetDropDownChain(4);
      }
      resetDropDownChain(4);
      loadExitsForDestinationRegionAndFacility(srcRegionSelected, srcFacilitySelected, srcExitSelected, desRegionSelected, desFacilitySelected);
    });

    //Destination Exits DropDown
    $('#desExitDrdn').on('change', function() {
      desExitSelected = $(this).find("option:selected").text();
      console.log(desExitSelected);
      if (desExitSelected === "SELECT EXIT") {
        resetDropDownChain(5);
      }
      loadCalculatedTollForAxles();
      //  console.log(JSON.parse(localStorage.trip1));

    });


    $('#btnTraffic').on('click', function() {
      console.log(this.trafficLayer);
      if (trafficLayer.getMap() == null) {
        trafficLayer.setMap(map);
        //  countyLayer.setMap(map);
      } else {
        trafficLayer.setMap(null);
      //  countyLayer.setMap(null);
      }
    });

    $('#btnReset').on('click', function() {

      //toggleTraffic(trafficLayer);
      //    console.log(this);
      resetMapFunction();
    });

    function toggleTraffic(trafficLayer) {
      console.log(trafficLayer.getMap());
      console.log(this);
      if (trafficLayer.getMap() == null) {
        trafficLayer.setMap(map);
      } else {
        trafficLayer.setMap(null);
      }
    }


    /*  $('btnSelectStart').on('click', function() {

        console.log("You just started a trip");

      });*/

    $('#btnRecentTrip0').on('click', function() {
      console.log("In recent trips");
      if (localStorage.length > 1) {
        var recentTripData = localStorage.getItem("SunpassTrip0");
        var parsedTripData = JSON.parse(recentTripData);
        srcRegionSelected = parsedTripData.source.region;
        srcRegionSelected = srcRegionSelected.toUpperCase();
        srcFacilitySelected = parsedTripData.source.facility;
        srcExitSelected = parsedTripData.source.exit;
        desRegionSelected = parsedTripData.destination.region;
        desRegionSelected = desRegionSelected.toUpperCase();
        desFacilitySelected = parsedTripData.destination.facility;
        desExitSelected = parsedTripData.destination.exit;
        axleCount = parsedTripData.axlecount;
        paymentId = parsedTripData.paymentMethod;

        console.log("Source region returned:" + srcRegionSelected);
        if (axleCount) {
          $("#ddlAxleCount").val(axleCount);
          $("#ddlPaymentType").val("Sunpass");
        }
        if (srcRegionSelected) {
          $("#srcRegionDrdn").val(srcRegionSelected);
          recentTripFlag = true;
        }
        loadFacilitiesForSourceRegion(srcRegionSelected);
        loadExitsForSourceRegionAndFacility(srcRegionSelected, srcFacilitySelected);
        loadDestinationRegionForGivenSource(srcRegionSelected, srcFacilitySelected, srcExitSelected);
        loadFacilitiesForDestinationRegion(srcRegionSelected, srcFacilitySelected, srcExitSelected, desRegionSelected);
        loadExitsForDestinationRegionAndFacility(srcRegionSelected, srcFacilitySelected, srcExitSelected, desRegionSelected, desFacilitySelected);
        loadCalculatedTollForAxles();
        loadDropDownImage(axleCount);
        loadPaymentMethodImage(paymentId);
      }
      console.log("Src: " + srcRegionSelected + ":" + srcFacilitySelected + ":" + srcExitSelected);
      console.log("Des: " + desRegionSelected + ":" + desFacilitySelected + ":" + desExitSelected);
      console.log("Axle: " + axleCount);

    });

    $('#btnRecentTrip1').on('click', function() {
      console.log("In recent trips 2");
      if (localStorage.length > 2) {
        var recentTripData = localStorage.getItem("SunpassTrip1");
        var parsedTripData = JSON.parse(recentTripData);
        srcRegionSelected = parsedTripData.source.region;
        srcRegionSelected = srcRegionSelected.toUpperCase();
        srcFacilitySelected = parsedTripData.source.facility;
        srcExitSelected = parsedTripData.source.exit;
        desRegionSelected = parsedTripData.destination.region;
        desRegionSelected = desRegionSelected.toUpperCase();
        desFacilitySelected = parsedTripData.destination.facility;
        desExitSelected = parsedTripData.destination.exit;
        axleCount = parsedTripData.axlecount;
        paymentId = parsedTripData.paymentMethod;



        if (axleCount) {
          $("#ddlAxleCount").val(axleCount);
          $("#ddlPaymentType").val("Sunpass");
        }
        if (srcRegionSelected) {
          $("#srcRegionDrdn").val(srcRegionSelected);
          recentTripFlag = true;
        }
        loadFacilitiesForSourceRegion(srcRegionSelected);
        loadExitsForSourceRegionAndFacility(srcRegionSelected, srcFacilitySelected);
        loadDestinationRegionForGivenSource(srcRegionSelected, srcFacilitySelected, srcExitSelected);
        loadFacilitiesForDestinationRegion(srcRegionSelected, srcFacilitySelected, srcExitSelected, desRegionSelected);
        loadExitsForDestinationRegionAndFacility(srcRegionSelected, srcFacilitySelected, srcExitSelected, desRegionSelected, desFacilitySelected);
        loadCalculatedTollForAxles();
        loadDropDownImage(axleCount);
        loadPaymentMethodImage(paymentId);
        //    loadFacilitiesForSourceRegion();
      }
      console.log("Src: " + srcRegionSelected + ":" + srcFacilitySelected + ":" + srcExitSelected);
      console.log("Des: " + desRegionSelected + ":" + desFacilitySelected + ":" + desExitSelected);
      console.log("Axle: " + axleCount);

    });

    $('#btnRecentTrip2').on('click', function() {
      console.log("In recent trips 3");
      if (localStorage.length > 3) {
        var recentTripData = localStorage.getItem("SunpassTrip2");
        var parsedTripData = JSON.parse(recentTripData);
        srcRegionSelected = parsedTripData.source.region;
        srcRegionSelected = srcRegionSelected.toUpperCase();
        srcFacilitySelected = parsedTripData.source.facility;
        srcExitSelected = parsedTripData.source.exit;
        desRegionSelected = parsedTripData.destination.region;
        desRegionSelected = desRegionSelected.toUpperCase();
        desFacilitySelected = parsedTripData.destination.facility;
        desExitSelected = parsedTripData.destination.exit;
        axleCount = parsedTripData.axlecount;
        paymentId = parsedTripData.paymentMethod;

        if (axleCount) {
          $("#ddlAxleCount").val(axleCount);
          $("#ddlPaymentType").val("Sunpass");
        }
        //  $("#ddlAxleCount").val(axleCount);
        /*    jQuery("#ddlAxleCount option").filter(function(){
                      return $.trim($(this).text()) ==  axleCount
              }).prop('selected', true);
              $('#ddlAxleCount').selectpicker('refresh');


              jQuery("#ddlPaymentType option").filter(function(){
                        return $.trim($(this).text()) ==  paymentMethod
                }).prop('selected', true);
                $('#ddlPaymentType').selectpicker('refresh');*/
        //    $("#ddlPaymentType").val("Sunpass");

        if (srcRegionSelected) {
          $("#srcRegionDrdn").val(srcRegionSelected);
          recentTripFlag = true;
        }
        loadFacilitiesForSourceRegion(srcRegionSelected);
        loadExitsForSourceRegionAndFacility(srcRegionSelected, srcFacilitySelected);
        loadDestinationRegionForGivenSource(srcRegionSelected, srcFacilitySelected, srcExitSelected);
        loadFacilitiesForDestinationRegion(srcRegionSelected, srcFacilitySelected, srcExitSelected, desRegionSelected);
        loadExitsForDestinationRegionAndFacility(srcRegionSelected, srcFacilitySelected, srcExitSelected, desRegionSelected, desFacilitySelected);
        loadCalculatedTollForAxles();
        loadDropDownImage(axleCount);
        loadPaymentMethodImage(paymentId);
      }
      console.log("Src: " + srcRegionSelected + ":" + srcFacilitySelected + ":" + srcExitSelected);
      console.log("Des: " + desRegionSelected + ":" + desFacilitySelected + ":" + desExitSelected);
      console.log("Axle: " + axleCount);

    });

    ///////////////////////////////////////////////////////////////TRIPDETAILS////////////////////////
    ///Trip Details Pop over toggle button jquery////////////////////////////////////////////////////
    $(document).ready(function() {
      $('[data-toggle="popover"]').popover({
        delay: 10
      });
    });
    var entryRD = "Select an Entry";
    var exitRD = "Select an Exit";
    var startTollCost = "0.00";
    var endTollCost = "0.00"



    $('[data-toggle="popover"]').on('inserted.bs.popover', function() {
      if (srcExitSelected && desExitSelected) {
        console.log(srcExitSelected);
        console.log(desExitSelected);
        entryRD = srcExitSelected;
        exitRD = desExitSelected;
      }
      if (tripDetailStart && tripDetailEnd) {
        if (paymentId) {
          if (paymentId === "sp") {
            startTollCost = tripDetailStart.sp > 0 ? tripDetailStart.sp : "0.00";
            endTollCost = tripDetailEnd.sp > 0 ? tripDetailEnd.sp : "0.00";
          } else {
            startTollCost = tripDetailStart.cash > 0 ? tripDetailStart.cash : "0.00";
            endTollCost = tripDetailEnd.cash > 0 ? tripDetailEnd.cash : "0.00";
          }
        }
      }
      startTollCost = parseFloat(startTollCost).toFixed(2);
      endTollCost = parseFloat(endTollCost).toFixed(2);

      // Create the inside link.
      $inside = $('<ul class="divider"><li style="font-weight: bold;">Start Point: ' + entryRD + ' - $ ' + startTollCost + ' </li></ul>');
      $('.popover-content').append($inside[0])

      if (tripDetailTollPlazas && paymentId) {
        tripDetailTollPlazas.forEach(function(tripElement) {
          if (paymentId === "sp") {
            $tollPlazasContent = $('<ul class="divider"><li>' + tripElement.name + ' - Sunpass - $' + parseFloat(tripElement.sp).toFixed(2) + ' </li></ul>');
          } else {
            $tollPlazasContent = $('<ul class="divider"><li>' + tripElement.name + ' - Cash - $' + parseFloat(tripElement.cash).toFixed(2) + ' </li></ul>');
          }
          $('.popover-content').append($tollPlazasContent[0])
        });
      }
      $outside = $('<ul class="divider"><li style="font-weight: bold;">End Point: ' + exitRD + ' - $ ' + endTollCost + ' </li></ul>');
      $('.popover-content').append($outside[0])
      //$tollPlazasContent = $('<ul class="divider"><li>Start Point:' + exitRD + ' </li><li>End Point:' + entryRD + ' </li></ul>');
      // Add the click event-handler only once
      //$('.popover-content').append($tollPlazasContent[0])
    })


    /////////////////Functions to Reset the DropDown Chain/////////////////////////////////////////////////////////////////
    function resetDropDownChain(ddlChainindex) {
      if (Boolean(isSinglePoint)) {
        $('#lblDestinationTripEnd').show();
        $('#desRegionDrdn').show();
        $('#desFacilityDrdn').show();
        $('#desExitDrdn').show();
        //  $('.selectpicker').selectpicker('refresh');
      }
      var chainElement;
      for (var arrInd = ddlArray.length - 1; arrInd > ddlChainindex; arrInd--) {
        chainElement = ddlArray[arrInd];
        console.log(chainElement);
        removeOptions(document.getElementById(chainElement));
      }
    }

    function removeOptions(selectbox) {
      var i;
      for (i = selectbox.options.length - 1; i > 0; i--) {
        selectbox.remove(i);
      }
    }
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    // JS functions ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    // Source  Region DropDown Methods
    function loadFacilitiesForSourceRegion(regionName) {
      //document.getElementById('#srcFacilityDrdn').reset();
      var data = "regionName=".concat(regionName);
      var facilityData;
      var newitemnum = 0;
      var newitemdesc = "SELECT FACILITY";
      axios.post(getFacilityurl, data)
        .then(function(response) {
          // console.log(response);
          if (response.status == 200) {
            this.someData = response.data.content;
            console.log(this.someData);
            facilityData = JSON.parse(this.someData);
            //  return this.someData;
            //  this.setState({ someKey: respose.data.content });
            removeOptions(document.getElementById("srcFacilityDrdn"));
            //  $('#srcFacilityDrdn').append('<option value="' + newitemnum + '">' + newitemdesc + '</option>');
            $(facilityData).each(function(index, element) {
              var k = 0
              $('#srcFacilityDrdn').append('<option value="' + k + '">' + element + '</option>');
              // $('#srcFacilityDrdn').val('').selectpicker('refresh');
            });
            console.log(recentTripFlag);
            if (Boolean(recentTripFlag)) {
              //  $("#srcFacilityDrdn").(srcFacilitySelected);
              jQuery("#srcFacilityDrdn option").filter(function() {
                return $.trim($(this).text()) == srcFacilitySelected
              }).prop('selected', true);
              $('#srcFacilityDrdn').selectpicker('refresh');
            }
          }
        }.bind(this))
        .catch(function(error) {
          console.log(error);
        });
    }



    // Exits pulled for given region and facility method
    function loadExitsForSourceRegionAndFacility(srcRegionSelected, srcFacilitySelected) {
      var newitemnum = 0;
      var newitemdesc = "SELECT EXIT";
      var data = {
        "region": srcRegionSelected,
        "facility": srcFacilitySelected
      };
      var sourceexitList;
      axios.post(getExitUrl, data)
        .then(function(response) {
          console.log(response);
          if (response.status == 200) {
            this.exitData = response.data.content;
            sourceexitList = JSON.parse(this.exitData);
            removeOptions(document.getElementById("srcExitDrdn"));
            //      $('#srcExitDrdn').append('<option value="' + newitemnum + '">' + newitemdesc + '</option>');
            $(sourceexitList).each(function(index, element) {
              var i = 0
              console.log("Index : " + i++);
              console.log(element); // data.fixLine, data.tarrifType, data.sms
              $('#srcExitDrdn').append('<option value="' + i + '">' + element + '</option>');
            });
            //console.log(regionData);
            //  this.setState({ someKey: respose.data.content });
            if (Boolean(recentTripFlag)) {
              jQuery("#srcExitDrdn option").filter(function() {
                return $.trim($(this).text()) == srcExitSelected
              }).prop('selected', true);
              $('#srcExitDrdn').selectpicker('refresh');
            }
          }
        }.bind(this))
        .catch(function(error) {
          console.log(error);
        });
    }

    // Qualified Regions pulled for given source
    function loadDestinationRegionForGivenSource(srcRegionSelected, srcFacilitySelected, srcExitSelected) {
      var desRegionList;
      var newitemnum = 0;
      var newitemdesc = "SELECT REGION";
      var data = {
        "region": srcRegionSelected,
        "facility": srcFacilitySelected,
        "exit": srcExitSelected
      };
      isSinglePoint = false;
      var singlePointCash = 0;
      var singlePointSunPass = 0;


      axios.post(getSinglePointStatusUrl, data)
        .then(function(response) {
          console.log(response);
          if (response.status == 200) {
            var destinationControlsStatus = response.data.content;
            //console.log(regionData);
            //  this.setState({ someKey: respose.data.content });
            isSinglePoint = JSON.parse(destinationControlsStatus);
            console.log(isSinglePoint);

            if (Boolean(isSinglePoint)) {
              //Calculate tolls and disable destination controls
              console.log("Calculate tolls and disable destination controls");
              $('#desRegionDrdn').hide();
              $('#desFacilityDrdn').hide();
              $('#desExitDrdn').hide();
              $('#lblDestinationTripEnd').hide();

              //loadSinglePointTollsperAxle(data, axleCount, isSinglePoint);
              console.log("Check Single Point Flag");
              bounds = new google.maps.LatLngBounds();
              axios.get(getTollPlazasUrl)
                .then(function(response) {
                  if (response.status == 200) {
                    tollPlazaData = response.data;
                    //goPopulateTollPoints(tollPlazasData.tollplazas);
                    tollPointsData = tollPlazaData.tollplazas;
                    for (var arrPointer in tollPointsData) {
                      /*    console.log(tollPointsData[arrPointer]);
                          console.log(data.region.trim())
                          console.log(data.facility.trim())
                          console.log(data.exit.trim())
                          console.log(tollPointsData[arrPointer].tollPlazaRegion.trim());
                          console.log(tollPointsData[arrPointer].tollPlazaFacility.trim());
                          console.log(tollPointsData[arrPointer].tollPlazaName.trim());*/
                      if (tollPointsData[arrPointer].tollPlazaRegion.trim().toUpperCase() === data.region.trim().toUpperCase()) {
                        //    console.log(data.region.trim() + "===" + tollPointsData[arrPointer].tollPlazaRegion.trim());
                        if (tollPointsData[arrPointer].tollPlazaFacility.trim().toUpperCase() === data.facility.trim().toUpperCase()) {
                          //      console.log(data.facility.trim() + "===" + tollPointsData[arrPointer].tollPlazaFacility.trim());
                          //  console.log(data.exit.trim() + "===" + tollPointsData[arrPointer].tollPlazaName.trim());
                          if (tollPointsData[arrPointer].tollPlazaName.trim().toUpperCase() === data.exit.trim().toUpperCase()) {
                            /////Check this code later
                            console.log(data.exit.trim() + "===" + tollPointsData[arrPointer].tollPlazaName.trim());
                            console.log("Printing in single point loop");
                            var tollPoints = new google.maps.LatLng(tollPointsData[arrPointer].tollPlazaCoordinates[0],
                              tollPointsData[arrPointer].tollPlazaCoordinates[1]);
                            var tollPointName = tollPointsData[arrPointer].tollPlazaName;
                            var tollValuePerAxle = tollPointsData[arrPointer].tollPerAxlePerMethod;
                            //    var lat = tollPointsData[arrPointer].tollPerAxlePerMethod[0];
                            //  var lng = tollPointsData[arrPointer].tollPerAxlePerMethod[1];
                            //      console.log(lat + " : " + lng);
                            //      var positionll = new google.maps.LatLng(lat, lng);
                            //    console.log(positionll);
                            bounds.extend(tollPoints);
                            //  positionGeoList.push(positionll);
                            map.fitBounds(bounds);
                            map.panToBounds(bounds);

                            for (axleVector in tollValuePerAxle) {
                              if (tollValuePerAxle[axleVector].axle === axleCount) {
                                console.log(paymentMethod);
                                console.log(paymentId);
                                if (paymentMethod === "cash") {
                                  singlePointSunPass = tollValuePerAxle[axleVector].cash;
                                  //  tollValue.spValue = singlePointSunPass;
                                } else {
                                  singlePointSunPass = tollValuePerAxle[axleVector].sunPass;
                                  //    tollValue.spValue = singlePointSunPass;
                                }
                                //    }
                              }
                            }
                            addMarker(tollPoints, tollPointName);
                          }
                        }
                      }
                    }
                    if (singlePointSunPass != 999) {
                      document.getElementById('lblTollValue').innerHTML = "$ " + singlePointSunPass.toFixed(2);
                    }
                  }
                })
                .catch(function(error) {
                  console.log(error);
                });
              $('.selectpicker').selectpicker('refresh');
            }
          }
        }.bind(this))
        .catch(function(error) {
          console.log(error);
        });
      console.log("Destination Exits call");
      console.log(isSinglePoint);
      axios.post(getDestinationRegionUrl, data)
        .then(function(response) {
          console.log(response);
          if (response.status == 200) {
            this.desRegionData = response.data.content;
            //console.log(regionData);
            //  this.setState({ someKey: respose.data.content });
            desRegionList = JSON.parse(this.desRegionData);
            removeOptions(document.getElementById("desRegionDrdn"));
            //    $('#desRegionDrdn').append('<option value="' + newitemnum + '">' + newitemdesc + '</option>');
            $(desRegionList).each(function(index, element) {
              var i = 0
              console.log("Index : " + i++);
              console.log(element); // data.fixLine, data.tarrifType, data.sms
              $('#desRegionDrdn').append('<option value="' + i + '">' + element + '</option>');
            });

            if (Boolean(recentTripFlag)) {
              //$("#desRegionDrdn").val(desRegionSelected);
              jQuery("#desRegionDrdn option").filter(function() {
                return $.trim($(this).text()) == desRegionSelected
              }).prop('selected', true);
              $('#desRegionDrdn').selectpicker('refresh');
            }
          }
        }.bind(this))
        .catch(function(error) {
          console.log(error);
        });

    }

    /*  //Destination Exits pulled for given region and facility method
      function loadDestinationExitsForSourceExit(srcRegionSelected, srcFacilitySelected, srcExitSelected) {
        //  var desExitList = getQualifiedExitsForSourceRegionalFacilityExit(srcRegionSelected, srcFacilitySelected, srcExitSelected, getDestinationExitsUrl);
        var desExitList;
        var newitemnum = 0;
        var newitemdesc = "SELECT EXIT";
        //    var desExitList = getQualifiedExits(srcRegionSelected, srcFacilitySelected, srcExitSelected, getDestinationExitsUrl);
        var data = {
          "region": srcRegionSelected,
          "facility": srcFacilitySelected,
          "exit": srcExitSelected
        };

        axios.post(getDestinationExitsUrl, data)
          .then(function(response) {
            console.log(response);
            if (response.status == 200) {
              this.desExitData = response.data.content;
              //console.log(regionData);
              //  this.setState({ someKey: respose.data.content });
              removeOptions(document.getElementById("desExitDrdn"));
              //    $('#desExitDrdn').append('<option value="' + newitemnum + '">' + newitemdesc + '</option>');
              desExitList = JSON.parse(this.desExitData);
              $(desExitList).each(function(index, element) {
                var i = 0
                console.log("Index : " + i++);
                console.log(element); // data.fixLine, data.tarrifType, data.sms
                $('#desExitDrdn').append('<option value="' + i + '">' + element + '</option>');
              });
              if(Boolean(recentTripFlag)){
                jQuery("#desExitDrdn option").filter(function(){
                          return $.trim($(this).text()) ==  desExitSelected
                  }).prop('selected', true);
                  $('#desExitDrdn').selectpicker('refresh');
            }

            }
          }.bind(this))
          .catch(function(error) {
            console.log(error);
          });



        //  $('.selectpicker').val('').selectpicker('refresh');
      } */

    //Pull regions for give source
    function getRegions(getRegionsurl) {
      var regionList = loadRegion(getRegionsurl);
      console.log(regionList);
    }

    // Destination Methods
    function loadFacilitiesForDestinationRegion(srcRegionSelected, srcFacilitySelected, srcExitSelected, regionName) {
      var desFacilities;
      var newitemnum = 0;
      var newitemdesc = "SELECT FACILITY";
      //    var desExitList = getQualifiedExits(srcRegionSelected, srcFacilitySelected, srcExitSelected, getDestinationExitsUrl);
      var data = {
        "region": srcRegionSelected,
        "facility": srcFacilitySelected,
        "exit": srcExitSelected,
        "destinationRegion": regionName
      };
      console.log(data);
      axios.post(getDestinationFacilitiesUrl, data)
        .then(function(response) {
          console.log(response);
          if (response.status == 200) {
            this.desfacilityData = response.data.content;
            //console.log(regionData);
            //  this.setState({ someKey: respose.data.content });
            desFacilities = JSON.parse(this.desfacilityData);
            removeOptions(document.getElementById("desFacilityDrdn"));
            //      $('#desFacilityDrdn').append('<option value="' + newitemnum + '">' + newitemdesc + '</option>');
            $(desFacilities).each(function(index, element) {
              var i = 0
              console.log("Index : " + i++);
              console.log(element); // data.fixLine, data.tarrifType, data.sms
              $('#desFacilityDrdn').append('<option value="' + i + '">' + element + '</option>');
            });

            if (Boolean(recentTripFlag)) {
              jQuery("#desFacilityDrdn option").filter(function() {
                return $.trim($(this).text()) == desFacilitySelected
              }).prop('selected', true);
              $('#desFacilityDrdn').selectpicker('refresh');
            }

          }
        }.bind(this))
        .catch(function(error) {
          console.log(error);
        });

    }

    /// Destination exits for End Trip Region and Facility
    function loadExitsForDestinationRegionAndFacility(srcRegionSelected, srcFacilitySelected, srcExitSelected, desRegionName, desFacilitySelected) {
      //  var desExitList = getExitsForRegionAndFacility(desRegionSelected, desFacilitySelected, getExitUrl);
      var newitemnum = 0;
      var newitemdesc = "SELECT EXIT";
      var data = {
        "region": srcRegionSelected,
        "facility": srcFacilitySelected,
        "exit": srcExitSelected,
        "destinationRegion": desRegionName,
        "destinationfacility": desFacilitySelected
      };
      var desExitList;
      axios.post(getDestinationExitsUrl, data)
        .then(function(response) {
          console.log(response);
          if (response.status == 200) {
            this.exitData = response.data.content;
            desExitList = JSON.parse(this.exitData);
            removeOptions(document.getElementById("desExitDrdn"));
            //    $('#desExitDrdn').append('<option value="' + newitemnum + '">' + newitemdesc + '</option>');
            $(desExitList).each(function(index, element) {
              var i = 0
              console.log("Index : " + i++);
              console.log(element); // data.fixLine, data.tarrifType, data.sms
              $('#desExitDrdn').append('<option value="' + i + '">' + element + '</option>');
            });

            if (Boolean(recentTripFlag)) {
              jQuery("#desExitDrdn option").filter(function() {
                return $.trim($(this).text()) == desExitSelected
              }).prop('selected', true);
              $('#desExitDrdn').selectpicker('refresh');
              recentTripFlag = false;
            }
            //console.log(regionData);
            //  this.setState({ someKey: respose.data.content });
          }
        }.bind(this))
        .catch(function(error) {
          console.log(error);
        });

    }

    //Load TollValues for SinglePoint Source regionalfacilityexits
    function loadSinglePointTollsperAxle(singlePointSrcData, singlepointAxleCount, singlePointFlag) {
      var singlePointCash = 0;
      var singlePointSunPass = 0;
      console.log("Check Single Point Flag: " + singlePointFlag);
      if (Boolean(singlePointFlag)) {
        console.log("Check Single Point Flag");
        axios.get(getTollPlazasUrl)
          .then(function(response) {
            if (response.status == 200) {
              tollPlazasData = response.data;
              //goPopulateTollPoints(tollPlazasData.tollplazas);
              for (var arrPointer in tollPointsData) {
                if ((tollPointsData[arrPointer].tollPlazaRegion === singlePointSrcData.region) &&
                  (tollPointsData[arrPointer].tollPlazaFacility === singlePointSrcData.facility) &&
                  (tollPointsData[arrPointer].tollPlazaName === singlePointSrcData.exit)) {
                  console.log("Printing in single point loop");
                  var tollPoints = new google.maps.LatLng(tollPointsData[arrPointer].tollPlazaCoordinates[0],
                    tollPointsData[arrPointer].tollPlazaCoordinates[1]);
                  var tollPointName = tollPointsData[arrPointer].tollPlazaName;
                  var tollValuePerAxle = tollPointsData[arrPointer].tollPerAxlePerMethod;
                  var lat = tollPointsData[arrPointer].tollPerAxlePerMethod[0];
                  var lng = tollPointsData[arrPointer].tollPerAxlePerMethod[1];
                  //      console.log(lat + " : " + lng);
                  var positionll = new google.maps.LatLng(lat, lng);
                  //    console.log(positionll);
                  bounds.extend(positionll);
                  //  positionGeoList.push(positionll);
                  map.fitBounds(bounds);
                  map.panToBounds(bounds);

                  for (axleVector in tollValuePerAxle) {
                    if (tollValuePerAxle[axleVector].axle === singlepointAxleCount) {
                      singlePointCash = tollValuePerAxle[axleVector].cash;
                      singlePointSunPass = tollValuePerAxle[axleVector].sunPass;
                      //tollValue.spValue = singlePointSunPass;
                    }
                  }
                  addMarker(tollPoints, tollPointName);
                }
              }
              if (singlePointSunPass != 999) {
                document.getElementById('lblTollValue').innerHTML = "$ " + singlePointSunPass.toFixed(2);
              }
            }
          })
          .catch(function(error) {
            console.log(error);
          });
      }

    }

    // Load TollRoutes between Trip Start to Trip end for given axle
    function loadCalculatedTollForAxles() {

      if (axleCount && srcRegionSelected && srcFacilitySelected && srcExitSelected &&
        desRegionSelected && desFacilitySelected && desExitSelected) {
        var tollCalcData = {
          "source": {
            "region": srcRegionSelected.toUpperCase(),
            "facility": srcFacilitySelected,
            "exit": srcExitSelected
          },

          "destination": {
            "region": desRegionSelected.toUpperCase(),
            "facility": desFacilitySelected,
            "exit": desExitSelected
          },

          "axlecount": axleCount,
          "paymentMethod": paymentId
        };
        console.log(tollCalcData);

        var tollRate = this;
        axios.post(getTollRoutesUrl, tollCalcData)
          .then(function(response) {
            console.log(response);
            if (response.status == 200) {
              this.tollRoutesData = response.data;
              tollRate = this.tollRoutesData;
              var spAmount = tollRate.results[0].tollAmounts.sp;
              var cashAmount = tollRate.results[0].tollAmounts.cash;
              tripDetails = tollRate.results[0].tollAmounts.routeAmount;
              tripDetailStart = tollRate.results[0].tollAmounts.routeAmount.start;
              tripDetailEnd = tollRate.results[0].tollAmounts.routeAmount.end;
              tripDetailTollPlazas = tollRate.results[0].tollAmounts.routeAmount.tollPlazas;
              if (spAmount !== undefined && paymentId === "sp") {
                generalToll = spAmount;
              }
              if (cashAmount !== undefined && paymentId === "cash") {
                generalToll = cashAmount;
              }
              localStorage.setItem("currentTrip", JSON.stringify(tollCalcData));
              console.log(localStorage.length);
              updateRecentTrips();
              loadRecentTripsFromLocal();
              document.getElementById('lblTollValue').innerHTML = "$ " + generalToll.toFixed(2);
            }
          }.bind(this))
          .catch(function(error) {
            console.log(error);
          });

        //Route Highlighting /usr/lib/jvm/java-8-oracle/jre/bin/java

        var tollSectionRouteGeoMetry = this;
        bounds = new google.maps.LatLngBounds();
        ///Passing Sample Data////
        axios.post(getRouteGeometryUrl, tollCalcData)
          .then(function(response) {
            console.log(response);
            if (response.status == 200) {
              this.tollSectionGeoData = response.data.content;
              tollSectionRouteGeoMetry = JSON.parse(this.tollSectionGeoData);
              var tripRoutes = tollSectionRouteGeoMetry.results[0].routes;
              if (tripRoutes !== undefined) {
                positionGeoList = [];
                console.log(tripRoutes.length);
                for (var i = 0; i < tripRoutes.length; i++) {
                  for (var j = 0; j < tripRoutes[i].route_geom.coordinates.length; j++) {
                    var lat = tripRoutes[i].route_geom.coordinates[j][1];
                    var lng = tripRoutes[i].route_geom.coordinates[j][0];
                    //      console.log(lat + " : " + lng);
                    var positionll = new google.maps.LatLng(lat, lng);
                    //    console.log(positionll);
                    bounds.extend(positionll);
                    positionGeoList.push(positionll);
                    //  console.log(positionGeoList);

                  }
                }
                var destinationLocation = positionGeoList.length;
                if (positionGeoList.length > 1) {
                  MarkSourceAndDestinationBubble(positionGeoList[0], positionGeoList[destinationLocation - 1]);
                }
                console.log("in polyfill");
                if (axlePath) {
                  console.log("Refresh polyfill")
                  axlePath.setPath(positionGeoList);
                } else {
                  axlePath = new google.maps.Polyline({
                    path: positionGeoList,
                    geodesic: true,
                    strokeColor: '#009d56',
                    strokeOpacity: 0.8,
                    strokeWeight: 4
                  });
                  console.log("new polyfillComplete")
                  axlePath.setMap(map);
                }
                map.fitBounds(bounds);
                map.panToBounds(bounds);
              }
            }
          }.bind(this))
          .catch(function(error) {
            console.log(error);
          });
      }
      //  $('lblTollValue').text =
    }

    ///////////////////////Update Recent Trips//////////////////////////////////////


    function updateRecentTrips() {
      var tripData;
      var tripitr;
      var myMap = new Map();
      //    console.log(trip0);
      if (localStorage.getItem("currentTrip") && localStorage.getItem("SunpassTrip0") && localStorage.getItem("SunpassTrip1") && localStorage.getItem("SunpassTrip2")) {
        tripData = localStorage.getItem("currentTrip");
        console.log(tripData);
        for (var i = 0; i < 3; i++) {
          var tripIndexItr = "SunpassTrip" + i;
          var item2LookUp = localStorage.getItem(tripIndexItr);
          console.log(item2LookUp);
          if (jsonEqual(tripData, item2LookUp)) {
            console.log(true); ///Updates hashmap to true if the trip already exists and Not unique
            myMap.set(tripIndexItr, true)
          } else {
            console.log(false); ///Updates hashmap to false if the trip doesn't exist  and is unique
            myMap.set(tripIndexItr, false);
          }
        }
      }
      // Persist in local storage if all trips are uniquetrip
      if (allUnique(myMap)) {
        persistLocalStorage();
      }

    }
    // Verify if atleast element one is not unique(true) return false else return true;
    function allUnique(UniqueMap) {
      var localMap = UniqueMap;
      for (var value of localMap.values()) {
        if (value === true) return false;
      }
      return true;
    }
    // Verify if two JSON objects are in fact equal in depth.
    function jsonEqual(a, b) {
      return JSON.stringify(a) === JSON.stringify(b);
    }

    function callUniqueRecentTrips(lookUpRouteWithNoPaymentId, tripDataOneOfThreeFromStorage) {
      var currentData = JSON.parse(lookUpRouteWithNoPaymentId);
      var recentData = JSON.parse(tripDataOneOfThreeFromStorage);
      var isUnique = false;

      var requestData = {
        "comparableTrips": [{
            "source": {
              "region": currentData.source.region,
              "facility": currentData.source.facility,
              "exit": currentData.source.exit
            },

            "destination": {
              "region": currentData.destination.region,
              "facility": currentData.destination.facility,
              "exit": currentData.destination.exit
            },

            "axlecount": currentData.axlecount,
            "paymentmethod": currentData.paymentMethod
          },
          {
            "source": {
              "region": recentData.source.region,
              "facility": recentData.source.facility,
              "exit": recentData.source.exit
            },

            "destination": {
              "region": recentData.destination.region,
              "facility": recentData.destination.facility,
              "exit": recentData.destination.exit
            },

            "axlecount": recentData.axlecount,
            "paymentmethod": "sp"
          }
        ]

      }

      console.log(JSON.stringify(requestData, null, " "));

      axios.post(getUniqueRecentTripUrl, requestData)
        .then(function(response) {
          console.log(response);
          if (response.status == 200) {
            this.uniqueTripVerificationData = response.data.uniquetrip;
            isTripUniqueFlag = this.uniqueTripVerificationData;
            console.log(this.uniqueTripVerificationData);
            console.log("IsTripUniqueFlag: " + isTripUniqueFlag);
          }
        }.bind(this))
        .catch(function(error) {
          console.log(error);
        });


      return isUnique;
    }



    function persistLocalStorage() {
      //    var lastTollCalculatedTrip = activeTrip;
      //    var tempTripData;
      if (localStorage.length > 0) {
        //        tempTripData = localStorage.getItem("currentTrip");
        if (localStorage.getItem("currentTrip")) {
          if (localStorage.getItem("SunpassTrip0")) {
            if (localStorage.getItem("SunpassTrip1")) {
              localStorage.setItem("SunpassTrip2", localStorage.getItem("SunpassTrip1"));
            }
            localStorage.setItem("SunpassTrip1", localStorage.getItem("SunpassTrip0"));
          }
          localStorage.setItem("SunpassTrip0", localStorage.getItem("currentTrip"));
        }
      }

      /*
        var qLength = queue.getLength();
        var generalTripId = "SunpassTrip";
        var queueData;
        if (qLength > 3) {
          qLength = 3;
        }
        for (i = 0; i < qLength; i++) {
          var tripId = generalTripId + (2 - i);
          console.log("tripId: " + tripId);
          queueData = queue.dequeue();
          console.log("Data in queue: " + queueData)
          localStorage.setItem(tripId, queueData);
          queue.enqueue(queueData);
        }*/
      console.log("Persisted to localStorage with size : " + localStorage.length);
    }

    function loadRecentTripsFromLocal() {
      var currentStartElement;
      var currentEndElement;
      var i = 0;

      if (localStorage.length > 0) {
        while (i < 3) {
          var tripIndexItr = "SunpassTrip" + i;
          currentStartElement = "'lblTrip" + (i + 1) + "StartValue'";
          currentEndElement = "'lblTrip" + (i + 1) + "EndValue'";
          console.log(tripIndexItr);
          var tripDataItr = localStorage.getItem(tripIndexItr);
          console.log(tripDataItr);
          var iteratedTripData = JSON.parse(tripDataItr);
          if (tripDataItr) {
            //  queue.enqueue(tripDataItr);
            console.log(currentStartElement);
            console.log(currentEndElement);
            console.log(iteratedTripData);
            console.log(iteratedTripData.source.exit);
            console.log(iteratedTripData.destination.exit);
            switch (i) {
              case 0:
                document.getElementById('lblTrip1StartValue').innerHTML = iteratedTripData.source.exit;
                document.getElementById('lblTrip1EndValue').innerHTML = iteratedTripData.destination.exit;
                break;
              case 1:
                document.getElementById('lblTrip2StartValue').innerHTML = iteratedTripData.source.exit;
                document.getElementById('lblTrip2EndValue').innerHTML = iteratedTripData.destination.exit;
                break;
              case 2:
                document.getElementById('lblTrip3StartValue').innerHTML = iteratedTripData.source.exit;
                document.getElementById('lblTrip3EndValue').innerHTML = iteratedTripData.destination.exit;
                break;
            }
          }
          i++;
        }
      }
    }
    ///////////////////////////////////////////////////////////////////////////////
    //// IMPORTANT MAP CORE OBJECT//////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////////////////
    function initMap() {
      var orlando = {
        lat: 28.46,
        lng: -81.431
      };
      map = new google.maps.Map(document.getElementById('map'), {
        zoom: 7,
        center: orlando,
        mapTypeControl: true,
        ////////// MAP  OR Satellite AND ZOOM AND STREETVIEW AND FULLSCREEN/////
        mapTypeControlOptions: {
          style: google.maps.MapTypeControlStyle.HORIZONTAL_BAR,
          position: google.maps.ControlPosition.BOTTOM_CENTER
        },
        zoomControl: true,
        scaleControl: true,
        streetViewControl: true,
        fullscreenControl: false, // set this flag if you need fullscreenControl options.
        fullscreenControlOptions: {
          position: google.maps.ControlPosition.LEFT_BOTTOM
        }
        //  mapTypeId: 'roadmap'
      });

      /*  var src = 'https://www.google.com/fusiontables/DataSource?docid=1WReDlncBRk7SCwXqDX41RzXF4es9NFruI05VT58';
        console.log("In KmlLayer");

        countyLayer = new google.maps.KmlLayer(src, {
          suppressInfoWindows: true,
          preserveViewport: false,
          map: map,
          clickable : false
        });
        console.log(countyLayer);

        countyLayer.setMap(map);*/
      countyLayer = new google.maps.FusionTablesLayer({
        query: {
          select: 'geometry',
          from: '12trATOP9qeUPfNppg_VOHFHXcaPq9QOqXphwKK2n', // Table name is county_regions_2015
          //from: '1WReDlncBRk7SCwXqDX41RzXF4es9NFruI05VT58' // Table name is county_regions
        },
        styleId: 2,
        styles: [{
          polygonOptions: {
            fillOpacity: 0.6
          }
        }],
        suppressInfoWindows: true,
        map: map
      });
      countyLayer.setMap(map);

      google.maps.event.addListener(countyLayer, 'click', function(kmlEvent) {
        selectedRegion = kmlEvent.row['name'].value;
        if (selectedRegion != "No Turnpike Facilities") {
         setBoundsToRegion(selectedRegion);
          //setShields();
          countyLayer.setMap(null);
        }
      });

      trafficLayer = new google.maps.TrafficLayer();
      opt = {
        minZoom: 7,
        maxZoom: 13
      };
      map.setOptions(opt);

      bounds = new google.maps.LatLngBounds();

      ////////////////////Legend Code begin again///////////////////////////////
      map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(legend);
      ////////////////////Legend Code end again ////////////////////////////////

      ////////////Marker code begins//////////////////////////////////////////
      ///////////////////////////////////////////////////////////////////////////
      loadDefaultPlazasAndExits();


      ///////////////////////Marker code ends/////////////////////////////////

      /////////////////////////Info Window Code begins/////////////////////////
    }

    function setBoundsToRegion(selectedRegion){
      var zoom2region;
      switch (selectedRegion) {
        case "Panhandle Bridges":
        zoom2region = "FLORIDA PANHANDLE";
          break;
        case "Orlando Area":
        zoom2region = "ORLANDO AREA";
          break;
        case "Tampa Area":
        zoom2region = "TAMPA BAY";
          break;
        case "Polk Parkway":
          zoom2region = "LAKELAND";
          break;
        case "Ticket System":
          zoom2region = "CENTRAL EAST COAST";
          break;
        case "South Florida":
          zoom2region = "SOUTH FLORIDA";
          break;
    }


   regionalBounds = new google.maps.LatLngBounds();
      var regionalInterchangeData;
      var selectedRegion="LAKELAND";
      var data = "regionName=".concat(zoom2region);
      axios.post(getInterchangesPerRegionurl, data)
        .then(function(response) {
           console.log(response);
          if (response.status == 200) {
            regionalInterchangeData = response.data.interchanges;
            //  return this.someData;
            for (var vector in regionalInterchangeData) {
            console.log(regionalInterchangeData[vector]);
                  var regionalInterchanges = new google.maps.LatLng(regionalInterchangeData[vector].exitCoordinates[0], regionalInterchangeData[vector].exitCoordinates[1]);
                  regionalBounds.extend(regionalInterchanges);
                  map.fitBounds(regionalBounds);
                  map.panToBounds(regionalBounds);
          }
        }
        }.bind(this))
        .catch(function(error) {
          console.log(error);
        });

  }


    function loadDefaultPlazasAndExits() {

      axios.get(getTollPlazasUrl)
        .then(function(response) {
          if (response.status == 200) {
            // console.log(response.data);
            //tollPlazasData = JSON.parse(response.data);
            tollPlazasData = response.data;
            //  console.log(tollPlazasData.tollplazas.length);
            //    console.log(tollPlazasData);
            //    console.log(locationData);
            goPopulateTollPoints(tollPlazasData.tollplazas);
          }
        })
        .catch(function(error) {
          console.log(error);
        });

      axios.get(getAllInterchangesUrl)
        .then(function(response) {
          if (response.status == 200) {
            //        console.log(response.data);
            //      console.log(response.data.interchanges);
            //    var allInterchangeData = JSON.parse(response.data.interchanges);
            var allInterchangeData = response.data.interchanges;
            //    console.log("All Interchanges length"+ allInterchangeData.length);
            //  goGetRegions(allInterchangeData);
            goPopulateInterchanges(allInterchangeData);
          }
        })
        .catch(function(error) {
          console.log(error);
        });
    }


    function goPopulateTollPoints(tollPointsData) {

      for (var arrPointer in tollPointsData) {

        var tollPoints = new google.maps.LatLng(tollPointsData[arrPointer].tollPlazaCoordinates[0],
          tollPointsData[arrPointer].tollPlazaCoordinates[1]);
        var tollPointName = tollPointsData[arrPointer].tollPlazaName;

        addTollPointMarker(tollPoints, tollPointName);
      }

    }

    function addTollPointMarker(location, tollPointName) {
      marker = new google.maps.Marker({
        position: location,
        map: map,
        icon: {
          path: google.maps.SymbolPath.CIRCLE,
          scale: 4,
          fillOpacity: 1,
          strokeOpacity: .8,
          strokeWeight: 1,
          fillColor: '#9797FF'
        },
      });
      addInfoWindow(marker, tollPointName);
      //  mapMarkers.push(marker);
    }

    //////Regular Info window addup for Toll plazas with just Name as  message
    function addInfoWindow(marker, message) {
      var infowindow = new google.maps.InfoWindow({
        content: message
      });

      google.maps.event.addListener(marker, 'click', function() {
        //  hideAllInfoWindows(map);
        if (otherActiveWindow != null) {
          //  hideAllInfoWindows(map, marker);
          console.log("non active window closed");
          otherActiveWindow.close();
        }
        infowindow.open(map, this);

        otherActiveWindow = infowindow;
      });
    }
    ////////////////////////////////////////////////////////////////////////////////

    function goPopulateInterchanges(interchangeData) {
      //console.log(locationData);
      var interchangeType = "entry";
      for (var vector in interchangeData) {
        //    console.log("for Key:" + key);
        //  var lat = interchangeData[vector].exitCoordinates[0];
        //  var lng = interchangeData[vector].exitCoordinates[1];
        var interchanges = new google.maps.LatLng(interchangeData[vector].exitCoordinates[0], interchangeData[vector].exitCoordinates[1]);
        var interChangeName = interchangeData[vector].exitName;
        var exitNum = interchangeData[vector].exitNum;
        var payPerPaymethod = interchangeData[vector].tollPerAxlePerMethod[0];

        var axleNum = payPerPaymethod.axle;
        var sunPassPerAxle = payPerPaymethod.sunPass.toFixed(2);
        var cashPerAxle = payPerPaymethod.cash.toFixed(2);
        var exitAttributes = {
          "exitRegion": interchangeData[vector].exitRegion,
          "exitFacility": interchangeData[vector].exitFacility,
          "exitName": interchangeData[vector].exitName,
          "exitNum": interchangeData[vector].exitNum
        };
        //  console.log(exitAttributes);

        //  var plazas = locationData[key][j][1];
        addInterchangesMarker(interchanges, interChangeName, exitNum, axleNum, sunPassPerAxle, cashPerAxle, exitAttributes, interchangeType);
      }
    }

    function addInterchangesMarker(location, interChangeName, interchangeNum, axleNum, sunPassPerAxle, cashPerAxle, exitAttributes, interchangeType) {
      var shade = '#97FF97'
      if (interchangeType === "exit") {
        shade: '#ff0000';
      }

      marker1 = new google.maps.Marker({
        position: location,
        map: map,
        icon: {
          path: google.maps.SymbolPath.CIRCLE,
          scale: 4,
          fillOpacity: 1,
          strokeOpacity: .8,
          strokeWeight: 1,
          fillColor: shade
        },
      });
      mapMarkers.push(marker1);
      addInterchangeInfoWindow(marker1, interChangeName, interchangeNum, axleNum, sunPassPerAxle, cashPerAxle, exitAttributes, location);
    }

    function MarkSourceAndDestinationBubble(srcGeoCo, desGeoCo) {
      SrcMarker = new google.maps.Marker({
        position: srcGeoCo,
        map: map,
        icon: 'img/Green_Arrow.png',
        scale: 8,
      });

      DesMarker = new google.maps.Marker({
        position: desGeoCo,
        map: map,
        icon: 'img/Red_Arrow.png',
        scale: 8,
      });
      //     delete2PointMarkers();
      twoPointMapMarkers.push(SrcMarker);
      twoPointMapMarkers.push(DesMarker);

    }

    function MarkSourceBubble(srcGeoCo) {
      SrcMarker = new google.maps.Marker({
        position: srcGeoCo,
        map: map,
        icon: 'img/Green_Arrow.png',
        scale: 8,
      });
      //     delete2PointMarkers();
      twoPointMapMarkers.push(SrcMarker);

    }

    function clear2PointMarkers() {
      setMapOn2Point(null);
    }

    function setMapOn2Point(map) {
      for (var i = 0; i < twoPointMapMarkers.length; i++) {
        twoPointMapMarkers[i].setMap(map);
      }
    }

    function delete2PointMarkers() {
      clear2PointMarkers();
      twoPointMapMarkers = [];
    }

    function btnSelectGUIStart() {
      console.log("In btnSelectGUIStart");
      console.log(GUIRegionSrc);
      console.log(GUIFacilitySrc);
      console.log(GUIExitSrc);
      //GUILatLngSrc
      MarkSourceBubble(GUILatLngSrc);
      loadDestinationExitsForSourceExit(GUIRegionSrc, GUIFacilitySrc, GUIExitSrc);

    }

    ///InfoWindow for interchange units with just complete InterchangeData.
    function addInterchangeInfoWindow(marker, message, interchangeNum, axleNum, sunPassPerAxle, cashPerAxle, exitAttributes, location) {

      //console.log(exitAttributes);
      //console.log(JSON.parse(exitAttributes));
      var infowindow = new google.maps.InfoWindow({
        //max
        content: message
      });


      google.maps.event.addListener(marker, 'click', function() {
        GUIRegionSrc = exitAttributes.exitRegion;
        GUIFacilitySrc = exitAttributes.exitFacility;
        GUIExitSrc = exitAttributes.exitName;
        GUILatLngSrc = location;
        infowindow.setContent('<p>Exit Region: ' + exitAttributes.exitRegion + '</p>' +
          '<p>Exit Facility: ' + exitAttributes.exitFacility + '</p>' +
          '<p>Exit Name: ' + exitAttributes.exitName + '</p>' +
          '<p>Exit Number: ' + interchangeNum + '</p>' +
          '<p>Axle Count: ' + axleNum + '&nbsp Sunpass: $' + sunPassPerAxle + ' &nbsp Cash: $' + cashPerAxle + '</p>' +
          '<button type="button" id="btnSelectStart" style="background-color:#12a523;width:100%;color:#fff;" onclick="btnSelectGUIStart()">Select Start</button>');

        if (otherActiveWindow != null) {
          console.log("non active window closed");
          otherActiveWindow.close();
        }

        infowindow.open(map, this);
        otherActiveWindow = infowindow;
      });
    }

    /////MAP GUI Destination pop up
    function loadDestinationExitsForSourceExit(srcRegionSelected, srcFacilitySelected, srcExitSelected) {
      var data = {
        "region": srcRegionSelected,
        "facility": srcFacilitySelected,
        "exit": srcExitSelected
      };
      console.log(data);
      axios.post(getMapDestinationExitsUrl, data)
        .then(function(response) {
          console.log(response);
          if (response.status == 200) {
            this.desMapAttributes = response.data.qualifiedExits;
            console.log(desMapAttributes);
            goPopulateExitInterchanges(desMapAttributes);
          }
        }.bind(this))
        .catch(function(error) {
          console.log(error);
        });
    }

    function goPopulateExitInterchanges(DestinationExitAttributes) {
      var interchangeType = "exit";
      for (var validExitPointer in DestinationExitAttributes) {

        var exitPoints = new google.maps.LatLng(DestinationExitAttributes[validExitPointer].exitCoordinates[0],
          DestinationExitAttributes[validExitPointer].exitCoordinates[1]);
        var interChangeName = DestinationExitAttributes[validExitPointer].exitName;
        var exitNum = DestinationExitAttributes[validExitPointer].exitNum;
        /*var payPerPaymethod = DestinationExitAttributes[validExitPointer].tollPerAxlePerMethod[0];
        var axleNum = payPerPaymethod.axle;
        var sunPassPerAxle = payPerPaymethod.sunPass;
        var cashPerAxle = payPerPaymethod.cash;*/
        var exitAttributes = {
          "exitRegion": DestinationExitAttributes[validExitPointer].exitRegion,
          "exitFacility": DestinationExitAttributes[validExitPointer].exitFacility,
          "exitName": DestinationExitAttributes[validExitPointer].exitName,
          "exitNum": DestinationExitAttributes[validExitPointer].exitNum,
          "entryRegion": DestinationExitAttributes[validExitPointer].entryRegion,
          "entryFacility": DestinationExitAttributes[validExitPointer].entryFacility,
          "entryName": DestinationExitAttributes[validExitPointer].entryName
        };

        addValidExitMarker(exitPoints, exitAttributes, interchangeType);
      }

      deleteMarkers();

      //  addInterchangesMarker(interchanges, interChangeName, exitNum, axleNum, sunPassPerAxle, cashPerAxle, exitAttributes, interchangeType);
    }

    function clearMarkers() {
      setMapOnAll(null);
    }

    function setMapOnAll(map) {
      for (var i = 0; i < mapMarkers.length; i++) {
        mapMarkers[i].setMap(map);
      }
    }

    function deleteMarkers() {
      clearMarkers();
      mapMarkers = [];
    }

    function addValidExitMarker(validExitMapPoints, validExitAttributes, interchangeType) {
      var shade = '#97FF97'
      if (interchangeType === "exit") {
        shade: '#ff0000';
      }

      marker2 = new google.maps.Marker({
        position: validExitMapPoints,
        map: map,
        icon: {
          path: google.maps.SymbolPath.CIRCLE,
          scale: 4,
          fillOpacity: 1,
          strokeOpacity: .8,
          strokeWeight: 1,
          fillColor: shade
        },
      });
      exitMapMarkers.push(marker2);
      addValidEndPointInfoWindow(marker2, validExitAttributes, interchangeType);
    }


    function addValidEndPointInfoWindow(marker, validExitAttributes, interchangeType) {

      //console.log(exitAttributes);
      //console.log(JSON.parse(exitAttributes));
      var infowindow = new google.maps.InfoWindow({
        content: validExitAttributes.exitName
      });


      google.maps.event.addListener(marker, 'click', function() {
        GUIRegionDes = validExitAttributes.exitRegion;
        GUIFacilityDes = validExitAttributes.exitFacility;
        GUIExitDes = validExitAttributes.exitName;

        infowindow.setContent('<p>Exit Region: ' + validExitAttributes.exitRegion + '</p>' +
          '<p>Exit Facility: ' + validExitAttributes.exitFacility + '</p>' +
          '<p>Exit Name: ' + validExitAttributes.exitName + '</p>' +
          '<p>Exit Number: ' + validExitAttributes.exitNum + '</p>' +
          '<p>Axle Count: ' + '2' + '&nbsp Sunpass:' + ' $' + '0.00' + ' &nbsp Cash: ' + ' $' + '0.00' + '</p>' +
          '<button type="button" id="btnCancelStart" style="background-color:#ff9933;width:30%;" onclick="resetMapFunction()">Reset</button>' +
          '<button type="button" id="btnSelectExit" style="background-color:#12a523;width:70%;color:#fff;position:relative;"onclick="afterExitSelected()">Select End</button>');

        if (otherActiveWindow != null) {
          console.log("non active window closed");
          otherActiveWindow.close();
        }

        infowindow.open(map, this);
        otherActiveWindow = infowindow;
      });
    }
    var otherActiveWindow;

    function afterExitSelected() {
      console.log("In myExitFunction");
      console.log(GUIRegionSrc);
      console.log(GUIFacilitySrc);
      console.log(GUIExitSrc);
      console.log(GUIRegionDes);
      console.log(GUIFacilityDes);
      console.log(GUIExitDes);
      srcRegionSelected = GUIRegionSrc;
      srcFacilitySelected = GUIFacilitySrc;
      srcExitSelected = GUIExitSrc;
      desRegionSelected = GUIRegionDes;
      desFacilitySelected = GUIFacilityDes;
      desExitSelected = GUIExitDes;
      /// To fix the corner scenario bug in case if the user selects two different destination for the same source successively from MAPGUI
      delete2PointMarkers();
      if (otherActiveWindow != null) {
        console.log("non active window closed");
        otherActiveWindow.close();
      }

      loadCalculatedTollForAxles();
      hideAllDropDownControls();
    }

    function hideAllDropDownControls() {
      $('#desRegionDrdn').hide();
      $('#desFacilityDrdn').hide();
      $('#desExitDrdn').hide();
      $('#lblDestinationTripEnd').hide();
      $('#srcRegionDrdn').hide();
      $('#srcFacilityDrdn').hide();
      $('#srcExitDrdn').hide();
      $('#lblSourceTripStart').hide();
    }

    function showAllDropDownControls() {
      $('#desRegionDrdn').show();
      $('#desFacilityDrdn').show();
      $('#desExitDrdn').show();
      $('#lblDestinationTripEnd').show();
      $('#srcRegionDrdn').show();
      $('#srcFacilityDrdn').show();
      $('#srcExitDrdn').show();
      $('#lblSourceTripStart').show();
    }

    function resetMapFunction() {
      //Unhide Dropdowns that were hidden
      resetTollValue();
      showAllDropDownControls();
      countyLayer.setMap(map);

      //Reset DropDown chain
      resetDropDownChain(0);
      //Delete all valid exit markers
      deleteVexitMarkers();
      delete2PointMarkers();

      //Load Origianl markers and exits
      loadDefaultPlazasAndExits();

      //reset zoom levels.
      //map.setOptions(opt);

      //Clear All route Highlighting
      if (axlePath) {
        positionGeoList = [];
        axlePath.setPath(positionGeoList);
      }

      map.setZoom(7);
    }

    function resetTollValue() {
      document.getElementById('lblTollValue').innerHTML = "$ " + "0.00";
    }


    /*function clearMarkers(){
      setMapOnAll(null);
    }*/
    function setMapOnVexit(map) {
      for (var i = 0; i < exitMapMarkers.length; i++) {
        exitMapMarkers[i].setMap(map);
      }
    }

    function deleteVexitMarkers() {
      setMapOnVexit(null);
      exitMapMarkers = [];
    }
  </script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBDpKvus3VMT0RQuDbJlWXZiZE2k4lQlrI&callback=initMap" async defer></script>
  <!--  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBDpKvus3VMT0RQuDbJlWXZiZE2k4lQlrI&callback=initMap"-->
  <!--  async defer></script>-->
</body>

</html>
